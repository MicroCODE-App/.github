---
globs: client/*
alwaysApply: false
---

# Client Component Rules

## Architecture

The client is a **React SPA** with:

- React Router for navigation
- Shadcn UI component library
- Tailwind CSS for styling
- i18next for internationalization

## Core Principles

### UI Components

- **ALWAYS** use Shadcn UI components when available
- **NEVER** build components from scratch if Shadcn equivalent exists
- If Shadcn component doesn't meet needs, wrap and extend it
- **ALWAYS** use Tailwind styling directly inside components (no external CSS files)

### Component Structure

- Components organized by folders
- Filenames: `snake_case`
- Component names: `PascalCase`
- Export all components from `/components/lib.js` for easy importing

## File Structure

### App (`src/app/`)

- `app.jsx` - React Router entry point
- `<App>` checks for active user token and sets Axios headers
- Sets default language
- Stripe Elements Context at highest level
- Import and include new routes here

### Routes (`src/routes/`)

- Separate routes by concern (one file per concern)
- Route format:

```javascript
{
  path: '/account',
  view: Account,
  layout: 'app',
  permission: 'user',
  title: 'account.index.title'
}
```

- Default permission: 'user' (no permission = public route)
- Default layout: 'app'
- Title references locale file/string

### Views (`src/views/`)

- Views are pages/screens
- Filenames: `snake_case`
- Component names: `PascalCase`
- Import components from `/components/lib`, not component files
- Wrap content in `<Animate>` component
- Data fetching handled inside View, passed to components

### Components (`src/components/`)

- Organized by folders
- Each component needs comment header:

```javascript
/***
 *
 *   COMPONENT_NAME
 *   Description of what it displays/does
 *
 *   DOCS
 *   Link to Shadcn docs if applicable
 *
 *   PROPS
 *   propName: description (type, required/optional)
 *
 **********/
```

- Export from `/components/lib.js`

## Data Fetching

- **ALWAYS** use `useAPI('url')` hook for data fetching
- Returns `{ data, loading, error }`
- Prepend result to variable starting with 'fetch':

```javascript
const fetchUser = useAPI("/api/user");
```

## Forms

- Built using React Hook Form
- Use custom `<Form>` component:

```javascript
<Form
  buttonText={t("form.button")}
  url="/api/user"
  method="PATCH"
  inputs={{
    name: {
      label: t("form.name.label"),
      type: "text",
      required: true,
      errorMessage: t("form.name.error"),
    },
  }}
  callback={(res) => {
    // callback logic
  }}
/>
```

## Dialogs & Notifications

### Dialogs

Use `viewContext.dialog.open()`:

```javascript
viewContext.dialog.open(
  {
    title: t("dialog.title"),
    description: t("dialog.description"),
    form: {
      /* form config */
    },
  },
  callback
);
```

### Notifications

Use `viewContext.notification()`:

```javascript
viewContext.notification({
  title: t("notification.title"),
  description: t("notification.text"),
});
```

## Authentication

- App wrapped in `<AuthProvider>`
- `<AuthProvider>` checks authentication on (re)load
- Contains signin/signout functions
- `/app/auth.jsx` contains `<PrivateRoute>` component
- Routes with `permission` prop render `<PrivateRoute>`

## Locales

- Use i18next
- Locales in `/locales` folder
- Create locale for each new view
- Views receive `t` function as prop
- Components import `useTranslation` from 'components/lib':

```javascript
const { t } = useTranslation();
```

## Settings

- Settings in `src/settings.json`
- Add new settings here
- Create keys for each env: 'development', 'production'

## Code Style

- Modern JavaScript (ES6+) with const/let
- Pure functions unless side effects needed
- Clear comments above non-trivial functions
- camelCase for variables/functions
- snake_case for filenames
- PascalCase for component names
- Route layouts: 'app', 'account', etc. (must match LayoutProvider)

## Styling

- **ALWAYS** use Tailwind CSS directly in components
- No external CSS files for component styles
- Use Tailwind utility classes
- Follow Shadcn component patterns

## Best Practices

- Data fetching in Views, pass data to components
- Components should be presentational
- Use context for shared state (ViewContext, AuthProvider)
- Follow existing patterns in codebase
- Maintain consistency with existing code style
